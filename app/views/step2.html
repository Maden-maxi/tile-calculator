<div ng-controller="View2Ctrl">

  <md-content layout="column" layout-padding>
    <div layout-gt-sm="row">
      <md-input-container class="md-block" flex-gt-sm="30">
        <label for="zoom">Zoom</label>
        <input type="number" id="zoom" ng-model="gridInfo.zoom">
      </md-input-container>
    </div>
    <md-tabs md-dynamic-height md-border-bottom md-selected="gridInfo.activeTab">
      <md-tab ng-if="stats.tiles.wall.walls && stats.appointment.wall" ng-repeat="wall in stats.tiles.wall.walls" md-on-select="showTab($index)" label="Wall #{{ $index+1 }}">
        <md-content class="md-padding">
          <h3>Стена#{{$index+1}}</h3>
          <ul>
            <li>layout: {{stats.layout.wall}}|tile sizes: {{stats.tile_sizes.wall | json}}</li>
            <li>width:{{wall.width}}|height:{{stats.tiles.wall.height}}</li>
            <li>columns: <i>{{ wall.width / stats.tile_sizes.wall.width }}</i></li>
            <li>row: <i>{{ stats.tiles.wall.height / stats.tile_sizes.wall.height }}</i></li>
            <li><b>Area</b>: {{ gridInfo.wall.rows }}x{{ gridInfo.wall.columns[$index] }} = {{ gridInfo.wall.rows * gridInfo.wall.columns[$index] }} </li>
          </ul>
          <div style="display: flex; justify-content: space-around;">
            <div ng-repeat="(clrI, clr) in stats.colors.wall" ng-style="{'background-color': clr, 'width': stats.tile_sizes.wall.width * gridInfo.zoom + 'px', 'height': stats.tile_sizes.wall.height * gridInfo.zoom + 'px'}" ondrag="" ondragend="console.log('drag')" ondragstart=""></div>
          </div>
          <input type="text" ng-readonly="true" ng-model="dragColor">
          <table>
            <tr ng-repeat="(index, row) in gridInfo.wall.grid[$index]">
              <th ng-style="{'width': stats.tile_sizes.wall.width * gridInfo.zoom + 'px', 'height': stats.tile_sizes.wall.height * gridInfo.zoom + 'px', 'background-color': col.color || '#fefefe'}" ng-if="index == 0" ng-repeat="(i, col) in row">
                <div><input type="color" ng-model="col.color">: {{col.color}}</div>
                <div>{{ (index+1) * (i+1) }}</div>

              </th>
              <td ng-style="{'width': stats.tile_sizes.wall.width* gridInfo.zoom + 'px', 'height': stats.tile_sizes.wall.height * gridInfo.zoom + 'px', 'background-color': col.color || '#fefefe'}" ng-if="index > 0" ng-repeat="(i, col) in row">
                <!--<div ng-if="i == 0"><i>{{ (index+1) * (i+1) }}.</i><input type="color" ng-model="col.color">: <b>{{col.color}}</b></div>-->
                <div ng-if="i == 0">
                  <md-input-container class="md-block" flex-gt-sm>
                    <label>Color</label>
                    <md-select ng-model="col.color">
                      <md-option value="none">
                        <div ng-style="{'background-color': 'none'}">none</div>
                      </md-option>
                      <md-option ng-repeat="(colorIndex, color) in stats.colors.wall" value="{{color}}">
                        <div ng-style="{'background-color': color}">{{color}}</div>
                      </md-option>
                    </md-select>
                  </md-input-container>
                </div>
                <span ng-if="i > 0">{{ (index+1) * (i+1) }}</span>

              </td>
            </tr>
          </table>

          <div>
            <span ng-if="stats.colors.wall" ng-repeat="color in stats.colors.wall" ng-style="{'background-color': color}">{{$index}}</span>
          </div>
        </md-content>
      </md-tab>
      <md-tab ng-if="stats.tiles.flor && stats.appointment.flor" md-on-select="showTab(stats.tiles.wall.walls.length || 0)" label="Flor">
        <md-content class="md-padding">
          <h3>Пол</h3>
          <p>width:{{stats.tiles.flor.width}}|height: {{stats.tiles.flor.height}}</p>
          <p>layout:{{stats.layout.flor}}|tile sizes: {{stats.tile_sizes.flor | json}}</p>
          <p>columns: <i>{{ stats.tiles.flor.width / stats.tile_sizes.flor.width }}</i></p>
          <p>row: <i>{{  stats.tiles.flor.height / stats.tile_sizes.flor.height }}</i></p>
          <p><b>Area</b>: {{ gridInfo.flor.rows }}x{{ gridInfo.flor.columns }} = {{ gridInfo.flor.rows * gridInfo.flor.columns }}</p>
          <table>
            <tr ng-repeat="(key, value) in gridInfo.flor.grid">
              <th ng-if="key == 0" ng-repeat="(k, v) in value">{{k + 1}} x {{key+1}} = {{ (k+1) * (key+1) }}</th>
              <td ng-if="key > 0" ng-repeat="(k, v) in value">{{k + 1}} x {{key+1}} = {{ (k+1) * (key+1) }}</td>
            </tr>
          </table>
          <div>

            <span ng-if="stats.colors.flor" ng-repeat="color in stats.colors.flor" ng-style="{'background-color': color}">{{$index}}</span>
          </div>
        </md-content>
      </md-tab>
    </md-tabs>

    <div class="ext-content">
      External content for `<pre>{{gridInfo | json}}</pre>`
      {{stats.tiles.wall.walls.length}}
    </div>

  </md-content>
  <pre>
    {{ stats | json }}
  </pre>

</div>